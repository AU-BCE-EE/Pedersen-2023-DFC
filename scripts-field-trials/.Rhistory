# reading in data
header <- c('date', 'time', 'mm')
no1 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no1clean.txt',
col.names = header)
no2 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no2clean.txt',
col.names = header)
no3 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no3clean.txt',
col.names = header)
no4 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no4clean.txt',
col.names = header)
no5 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no5clean.txt',
col.names = header)
no6 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no6clean.txt',
col.names = header)
no7 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no7clean.txt',
col.names = header)
no8 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no8clean.txt',
col.names = header)
no9 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no9clean.txt',
col.names = header)
no10 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no10clean.txt',
col.names = header)
no11 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no11clean.txt',
col.names = header)
no12 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no12clean.txt',
col.names = header)
no13 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no13clean.txt',
col.names = header)
no14 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no14clean.txt',
col.names = header)
no15 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no15clean.txt',
col.names = header)
no16 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no16clean.txt',
col.names = header)
no17 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no17clean.txt',
col.names = header)
no1$exp <- 'no1'; no2$exp <- 'no2'; no3$exp <- 'no3';
no4$exp <- 'no4'; no5$exp <- 'no5'; no6$exp <- 'no6';
no7$exp <- 'no7'; no8$exp <- 'no8'; no9$exp <- 'no9';
no10$exp <- 'no10'; no11$exp <- 'no11'; no12$exp <- 'no12';
no13$exp <- 'no13'; no14$exp <- 'no14'; no15$exp <- 'no15';
no16$exp <- 'no16'; no17$exp <- 'no17';
no1 <- no1[! no1$mm > 120, ]; no4 <- no4[! no4$mm > 120, ]; no7 <- no7[! no7$mm > 120, ];
no2 <- no2[! no2$mm > 120, ]; no5 <- no5[! no5$mm > 120, ]; no8 <- no8[! no8$mm > 120, ];
no3 <- no3[! no3$mm > 120, ]; no6 <- no6[! no6$mm > 120, ]; no9 <- no9[! no9$mm > 120, ];
no10 <- no10[! no10$mm > 120, ]; no11 <- no11[! no11$mm > 120, ]; no12 <- no12[! no12$mm > 120, ];
no13 <- no13[! no13$mm > 120, ]; no14 <- no14[! no14$mm > 120, ]; no15 <- no15[! no15$mm > 120, ];
no16 <- no16[! no16$mm > 120, ]; no17 <- no17[! no17$mm > 120, ];
no1$treat <- 'water'; no2$treat <- 'water'; no3$treat <- 'water';no4$treat <- 'water'; no5$treat <- 'water'; no6$treat <- 'water';
no7$treat <- 'separated'; no8$treat <- 'separated'; no9$treat <- 'separated'; no10$treat <- 'separated'; no11$treat <- 'separated'; no12$treat <- 'separated'
no13$treat <- 'untreated'; no14$treat <- 'untreated'; no15$treat <- 'untreated'; no16$treat <- 'untreated'; no17$treat <- 'untreated';
no1$elapsed.csek <- c(1:nrow(no1)); no4$elapsed.csek <- c(1:nrow(no4)); no7$elapsed.csek <- c(1:nrow(no7))
no2$elapsed.csek <- c(1:nrow(no2)); no5$elapsed.csek <- c(1:nrow(no5)); no6$elapsed.csek <- c(1:nrow(no6))
no3$elapsed.csek <- c(1:nrow(no3)); no8$elapsed.csek <- c(1:nrow(no8)); no9$elapsed.csek <- c(1:nrow(no9))
no10$elapsed.csek <- c(1:nrow(no10)); no11$elapsed.csek <- c(1:nrow(no11)); no12$elapsed.csek <- c(1:nrow(no12))
no13$elapsed.csek <- c(1:nrow(no13)); no14$elapsed.csek <- c(1:nrow(no14)); no15$elapsed.csek <- c(1:nrow(no15))
no16$elapsed.csek <- c(1:nrow(no16)); no17$elapsed.csek <- c(1:nrow(no17));
dat <- rbind(no1, no2, no3, no4, no5, no6, no7, no8, no9, no10, no11, no12, no13, no14, no15, no16, no17)
# plots of raw data:
ggplot(dat, aes(elapsed.csek, mm , color = treat)) + geom_point()
ggplot(dat, aes(elapsed.csek, mm , color = treat)) + geom_point() + xlim(0, 500)
# exp7 there is clearly something wrong, the sensor must have been moved. it is removed.
dat <- dat[! dat$exp == 'no7', ]
dat$mm <- 100 - dat$mm
dat <- mutate(group_by(dat, exp), mm.new = 100 - mm[1] + mm)
ggplot(dat, aes(elapsed.csek, mm.new , color = treat)) + geom_point() + xlim(0, 300) + ylim(90, 100)
ggplot(dat, aes(elapsed.csek, mm.new , color = treat)) + geom_point() + xlim(0, 2000)
dat$min <- dat$elapsed.csek / 600
ggplot(dat[dat$treat == 'untreated', ], aes(min, mm.new , color = exp)) + geom_point() + xlim(0, 0.5) + ylim(90, 105)
ggplot(dat[dat$treat == 'separated', ], aes(min, mm.new , color = exp)) + geom_point() + xlim(0, 0.5) + ylim(90, 105)
ggplot(dat[dat$treat == 'water', ], aes(min, mm.new , color = exp)) + geom_point() + xlim(0, 0.5) + ylim(90, 105)
ggplot(dat, aes(min, mm.new , color = treat)) + geom_point() + xlim(0, 0.5) + ylim(90, 105)
ggplot(dat, aes(min, mm.new , color = exp)) + geom_point() + xlim(0, 0.5) + ylim(90, 105)
ggplot(dat[dat$treat == 'untreated', ], aes(min, mm.new , color = exp)) + geom_point() + xlim(0, 0.5) + ylim(90, 105)
ggplot(dat, aes(min, mm.new , color = treat)) + geom_point() + xlim(0, 0.5) + ylim(90, 105)
# sensor test
# packages:
library(ggplot2)
library(dplyr)
# no8 is no good, it is jumping a lot. Accidently moved the black cloth covering the sensor which is probably why.
# reading in data
header <- c('date', 'time', 'mm')
no1 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no1clean.txt',
col.names = header)
no2 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no2clean.txt',
col.names = header)
no3 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no3clean.txt',
col.names = header)
no4 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no4clean.txt',
col.names = header)
no5 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no5clean.txt',
col.names = header)
no6 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no6clean.txt',
col.names = header)
no7 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no7clean.txt',
col.names = header)
no8 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no8clean.txt',
col.names = header)
no9 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no9clean.txt',
col.names = header)
no10 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no10clean.txt',
col.names = header)
no11 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no11clean.txt',
col.names = header)
no12 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no12clean.txt',
col.names = header)
no13 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no13clean.txt',
col.names = header)
no14 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no14clean.txt',
col.names = header)
no15 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no15clean.txt',
col.names = header)
no16 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no16clean.txt',
col.names = header)
no17 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no17clean.txt',
col.names = header)
no1$exp <- 'no1'; no2$exp <- 'no2'; no3$exp <- 'no3';
no4$exp <- 'no4'; no5$exp <- 'no5'; no6$exp <- 'no6';
no7$exp <- 'no7'; no8$exp <- 'no8'; no9$exp <- 'no9';
no10$exp <- 'no10'; no11$exp <- 'no11'; no12$exp <- 'no12';
no13$exp <- 'no13'; no14$exp <- 'no14'; no15$exp <- 'no15';
no16$exp <- 'no16'; no17$exp <- 'no17';
no1 <- no1[! no1$mm > 120, ]; no4 <- no4[! no4$mm > 120, ]; no7 <- no7[! no7$mm > 120, ];
no2 <- no2[! no2$mm > 120, ]; no5 <- no5[! no5$mm > 120, ]; no8 <- no8[! no8$mm > 120, ];
no3 <- no3[! no3$mm > 120, ]; no6 <- no6[! no6$mm > 120, ]; no9 <- no9[! no9$mm > 120, ];
no10 <- no10[! no10$mm > 120, ]; no11 <- no11[! no11$mm > 120, ]; no12 <- no12[! no12$mm > 120, ];
no13 <- no13[! no13$mm > 120, ]; no14 <- no14[! no14$mm > 120, ]; no15 <- no15[! no15$mm > 120, ];
no16 <- no16[! no16$mm > 120, ]; no17 <- no17[! no17$mm > 120, ];
no1$treat <- 'water'; no2$treat <- 'water'; no3$treat <- 'water';no4$treat <- 'water'; no5$treat <- 'water'; no6$treat <- 'water';
no7$treat <- 'separated'; no8$treat <- 'separated'; no9$treat <- 'separated'; no10$treat <- 'separated'; no11$treat <- 'separated'; no12$treat <- 'separated'
no13$treat <- 'untreated'; no14$treat <- 'untreated'; no15$treat <- 'untreated'; no16$treat <- 'untreated'; no17$treat <- 'untreated';
no1$elapsed.csek <- c(1:nrow(no1)); no4$elapsed.csek <- c(1:nrow(no4)); no7$elapsed.csek <- c(1:nrow(no7))
no2$elapsed.csek <- c(1:nrow(no2)); no5$elapsed.csek <- c(1:nrow(no5)); no6$elapsed.csek <- c(1:nrow(no6))
no3$elapsed.csek <- c(1:nrow(no3)); no8$elapsed.csek <- c(1:nrow(no8)); no9$elapsed.csek <- c(1:nrow(no9))
no10$elapsed.csek <- c(1:nrow(no10)); no11$elapsed.csek <- c(1:nrow(no11)); no12$elapsed.csek <- c(1:nrow(no12))
no13$elapsed.csek <- c(1:nrow(no13)); no14$elapsed.csek <- c(1:nrow(no14)); no15$elapsed.csek <- c(1:nrow(no15))
no16$elapsed.csek <- c(1:nrow(no16)); no17$elapsed.csek <- c(1:nrow(no17));
dat <- rbind(no1, no2, no3, no4, no5, no6, no7, no8, no9, no10, no11, no12, no13, no14, no15, no16, no17)
# plots of raw data:
ggplot(dat, aes(elapsed.csek, mm , color = treat)) + geom_point()
ggplot(dat, aes(elapsed.csek, mm , color = treat)) + geom_point() + xlim(0, 500)
# exp7 there is clearly something wrong, the sensor must have been moved. it is removed.
dat <- dat[! dat$exp == 'no7', ]
dat$mm <- 100 - dat$mm
dat <- mutate(group_by(dat, exp), mm.new = 100 - mm[1] + mm)
ggplot(dat, aes(elapsed.csek, mm.new , color = treat)) + geom_point() + xlim(0, 300) + ylim(90, 100)
ggplot(dat, aes(elapsed.csek, mm.new , color = treat)) + geom_point() + xlim(0, 2000)
dat$min <- dat$elapsed.csek / 600
ggplot(dat, aes(min, mm.new , color = treat)) + geom_point() + xlim(0, 0.5) + ylim(90, 105)
ggplot(dat, aes(min, mm.new , color = treat)) + geom_point() + xlim(0, 0.5) + ylim(NA, 102)
ggplot(dat, aes(min, mm.new , color = treat)) + geom_point() + xlim(0, 0.5) + ylim(80, 102)
# sensor test
# packages:
library(ggplot2)
library(dplyr)
# no8 is no good, it is jumping a lot. Accidently moved the black cloth covering the sensor which is probably why.
# reading in data
header <- c('date', 'time', 'mm')
no1 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no1clean.txt',
col.names = header)
no2 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no2clean.txt',
col.names = header)
no3 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no3clean.txt',
col.names = header)
no4 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no4clean.txt',
col.names = header)
no5 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no5clean.txt',
col.names = header)
no6 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no6clean.txt',
col.names = header)
no7 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no7clean.txt',
col.names = header)
no8 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no8clean.txt',
col.names = header)
no9 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no9clean.txt',
col.names = header)
no10 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no10clean.txt',
col.names = header)
no11 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no11clean.txt',
col.names = header)
no12 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no12clean.txt',
col.names = header)
no13 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no13clean.txt',
col.names = header)
no14 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no14clean.txt',
col.names = header)
no15 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no15clean.txt',
col.names = header)
no16 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no16clean.txt',
col.names = header)
no17 <- read.table('C:/Users/au583430/OneDrive - Aarhus Universitet/Dokumenter/MAG/infiltrations sensor/220615 test 5/data/no17clean.txt',
col.names = header)
no1$exp <- 'no1'; no2$exp <- 'no2'; no3$exp <- 'no3';
no4$exp <- 'no4'; no5$exp <- 'no5'; no6$exp <- 'no6';
no7$exp <- 'no7'; no8$exp <- 'no8'; no9$exp <- 'no9';
no10$exp <- 'no10'; no11$exp <- 'no11'; no12$exp <- 'no12';
no13$exp <- 'no13'; no14$exp <- 'no14'; no15$exp <- 'no15';
no16$exp <- 'no16'; no17$exp <- 'no17';
no1 <- no1[! no1$mm > 120, ]; no4 <- no4[! no4$mm > 120, ]; no7 <- no7[! no7$mm > 120, ];
no2 <- no2[! no2$mm > 120, ]; no5 <- no5[! no5$mm > 120, ]; no8 <- no8[! no8$mm > 120, ];
no3 <- no3[! no3$mm > 120, ]; no6 <- no6[! no6$mm > 120, ]; no9 <- no9[! no9$mm > 120, ];
no10 <- no10[! no10$mm > 120, ]; no11 <- no11[! no11$mm > 120, ]; no12 <- no12[! no12$mm > 120, ];
no13 <- no13[! no13$mm > 120, ]; no14 <- no14[! no14$mm > 120, ]; no15 <- no15[! no15$mm > 120, ];
no16 <- no16[! no16$mm > 120, ]; no17 <- no17[! no17$mm > 120, ];
no1$treat <- 'water'; no2$treat <- 'water'; no3$treat <- 'water';no4$treat <- 'water'; no5$treat <- 'water'; no6$treat <- 'water';
no7$treat <- 'separated'; no8$treat <- 'separated'; no9$treat <- 'separated'; no10$treat <- 'separated'; no11$treat <- 'separated'; no12$treat <- 'separated'
no13$treat <- 'untreated'; no14$treat <- 'untreated'; no15$treat <- 'untreated'; no16$treat <- 'untreated'; no17$treat <- 'untreated';
no1$elapsed.csek <- c(1:nrow(no1)); no4$elapsed.csek <- c(1:nrow(no4)); no7$elapsed.csek <- c(1:nrow(no7))
no2$elapsed.csek <- c(1:nrow(no2)); no5$elapsed.csek <- c(1:nrow(no5)); no6$elapsed.csek <- c(1:nrow(no6))
no3$elapsed.csek <- c(1:nrow(no3)); no8$elapsed.csek <- c(1:nrow(no8)); no9$elapsed.csek <- c(1:nrow(no9))
no10$elapsed.csek <- c(1:nrow(no10)); no11$elapsed.csek <- c(1:nrow(no11)); no12$elapsed.csek <- c(1:nrow(no12))
no13$elapsed.csek <- c(1:nrow(no13)); no14$elapsed.csek <- c(1:nrow(no14)); no15$elapsed.csek <- c(1:nrow(no15))
no16$elapsed.csek <- c(1:nrow(no16)); no17$elapsed.csek <- c(1:nrow(no17));
dat <- rbind(no1, no2, no3, no4, no5, no6, no7, no8, no9, no10, no11, no12, no13, no14, no15, no16, no17)
# plots of raw data:
ggplot(dat, aes(elapsed.csek, mm , color = treat)) + geom_point()
ggplot(dat, aes(elapsed.csek, mm , color = treat)) + geom_point() + xlim(0, 500)
# exp7 there is clearly something wrong, the sensor must have been moved. it is removed.
dat <- dat[! dat$exp == 'no7', ]
dat$mm <- 100 - dat$mm
dat <- mutate(group_by(dat, exp), mm.new = 100 - mm[1] + mm)
ggplot(dat, aes(elapsed.csek, mm.new , color = treat)) + geom_point() + xlim(0, 300) + ylim(90, 100)
ggplot(dat, aes(elapsed.csek, mm.new , color = treat)) + geom_point() + xlim(0, 2000)
dat$min <- dat$elapsed.csek / 600
ggplot(dat, aes(min, mm.new , color = treat)) + geom_point() + xlim(0, 0.5) + ylim(80, 102)
ggplot(dat, aes(min, mm.new , color = treat)) + geom_point() + xlim(0, 3.4)
ggplot(dat, aes(min, mm.new , color = treat)) + geom_point()
install.packages("NADA")
library(NADA)
data(asExample)
data(AsExample)
data(ShePyrene)
attach(ShePyrene)
names(ShePyrene)
View(ShePyrene)
mean(ShePyrene$Pyrene)
sd(ShePyrene$Pyre)
sd(ShePyrene$Pyrene)
summary(Pyrene)
mean(Pyrene)
sd(Pyrene)
summary(Pyrene)
censummary(Pyrene, PyreneCen)
pkym = cenfit(Pyrne, PyreneCen)
pkym = cenfit(Pyrene, PyreneCen)
pykm
pykm = cenfit(Pyrene, PyreneCen)
pykm
mean(Pyrene)
sd(Pyrene)
plot(pykm)
library(ggplot2)
library(dplyr)
library(plyr)
library(data.table)
# reading in data
filelist = list.files(path = '.',
recursive = TRUE,
pattern = '\\.txt$',
full.names = TRUE)
DT <- rbindlist(sapply(filelist, fread, simplify = FALSE), use.names = TRUE, idcol = 'FileName')
# test of recovery of NH3 from NH4Cl solution.
rm(list = ls())
dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source('functions.R')
source('packages.R')
source('load.R')
source('subset_and_clean.R')
source('slurry_soil.R')
source('bLS_dataframe.R')
source('DFC_dataframe.R')
source('temp_sensors_dataframe.R')
source('subset_weather.R')
source('mearge.R')
source('subset_stats.R')
rm(list = ls())
dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source('functions.R')
source('packages.R')
source('load.R')
source('subset_and_clean.R')
source('slurry_soil.R')
# adding elapsed time:
bb$date.time <- paste(bb$st_date, bb$st_time)
bb$date.time<-ymd_hms(bb$date.time)
View(bb)
rm(list = ls())
dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source('functions.R')
source('packages.R')
source('load.R')
source('subset_and_clean.R')
source('slurry_soil.R')
# test of recovery of NH3 from NH4Cl solution.
rm(list = ls())
dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source('functions.R')
source('packages.R')
### DFC data
dA <- read.csv('../data/expA_221217.csv', sep = ';')
dB <- read.csv('../data/expB_221217.csv', sep = ';')
dC_in <- read.csv('../data/expC_IN_221217.csv')
dC_th <- read.csv('../data/expC_TH_221217.csv')
### bLS data
bB <- read.table('../data/DFC_1_results_16_12_2022.txt', header = TRUE, fill = TRUE)
bC_in <- read.table('../data/DFC_2_east_results_20_03_2023.txt', header = TRUE, fill = TRUE)
bC_in <- read.table('../data/DFC_2_east_results_20_03_2023.txt', header = TRUE, fill = TRUE)
bC_in <- read.table('../data/DFC_2_east_results_20_03_2023.txt', header = TRUE, fill = TRUE)
bC_in <- read.table('../data/DFC_2_east_results_20_03_2023.txt', header = TRUE, fill = TRUE)
### bLS data
bB <- read.table('../data/DFC_1_results_16_12_2022.txt', header = TRUE, fill = TRUE)
# test of recovery of NH3 from NH4Cl solution.
rm(list = ls())
dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source('functions.R')
source('packages.R')
bC_in <- read.table('../data/DFC_2_east_results_20_03_2023.txt', header = TRUE, fill = TRUE)
### DFC data
dA <- read.csv('../data/expA_221217.csv', sep = ';')
dB <- read.csv('../data/expB_221217.csv', sep = ';')
dC_in <- read.csv('../data/expC_IN_221217.csv')
dC_th <- read.csv('../data/expC_TH_221217.csv')
### bLS data
bB <- read.table('../data/DFC_1_results_16_12_2022.txt', header = TRUE, fill = TRUE)
bC_in <- read.table('../data/DFC_2_east_results_20_03_2023.txt', header = TRUE, fill = TRUE)
bC_th <- read.table('../data/DFC_2_west_results_20_03_2023.txt', header = TRUE, fill = TRUE)
# test of recovery of NH3 from NH4Cl solution.
rm(list = ls())
dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source('functions.R')
source('packages.R')
### DFC data
dA <- read.csv('../data/expA_221217.csv', sep = ';')
dB <- read.csv('../data/expB_221217.csv', sep = ';')
dC_in <- read.csv('../data/expC_IN_221217.csv')
dC_th <- read.csv('../data/expC_TH_221217.csv')
### bLS data
bB <- read.table('../data/DFC_1_results_16_12_2022.txt', header = TRUE, fill = TRUE)
bC_in <- read.table('../data/DFC_2_east_results_20_03_2023.txt', header = TRUE, fill = TRUE)
bC_th <- read.table('../data/DFC_2_west_results_20_03_2023.txt', header = TRUE, fill = TRUE)
bC_th <- read.table('../data/DFC_2_west_results_20_03_2023_JP.txt', header = TRUE, fill = TRUE)
# test of recovery of NH3 from NH4Cl solution.
rm(list = ls())
dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source('functions.R')
source('packages.R')
### DFC data
dA <- read.csv('../data/expA_221217.csv', sep = ';')
dB <- read.csv('../data/expB_221217.csv', sep = ';')
dC_in <- read.csv('../data/expC_IN_221217.csv')
dC_th <- read.csv('../data/expC_TH_221217.csv')
### bLS data
bB <- read.table('../data/DFC_1_results_16_12_2022.txt', header = TRUE, fill = TRUE)
bC_in <- read.table('../data/DFC_2_east_results_20_03_2023_JP.txt', header = TRUE, fill = TRUE)
bC_th <- read.table('../data/DFC_2_west_results_20_03_2023_JP.txt', header = TRUE, fill = TRUE)
### soil and slurry data
sl <- read.xlsx('../data/slurry_soil.xlsx', sheet = 1)
so <- read.xlsx('../data/slurry_soil.xlsx', sheet = 2)
# precipitation data
pre <- read.table('../data/temp.txt', header = TRUE)
### temperature sensor data
dtA <- read.csv('../data/temp_log_A.csv', sep = ';')
dtB <- read.csv('../data/temp_log_B.csv', sep = ';')
dtC <- read.csv('../data/temp_log_C.csv', sep = ';')
dtD <- read.csv('../data/temp_log_D.csv', sep = ';')
source('subset_and_clean.R')
source('slurry_soil.R')
# adding elapsed time:
bb$date.time <- paste(bb$st_date, bb$st_time)
bb$date.time<-ymd_hms(bb$date.time)
bb$fac <- paste(bb$tk, bb$app.meth)
bb$Vid <- 0
bb$Vid[1:3] <- c('V1', 'V2', 'v3')
splitbb <- split(bb, f = bb$fac)
new.names <- bb$Vid[1:3]
for (i in 1:3){
assign(new.names[i], splitbb[[i]])
}
z = list(V1, V2, v3)
new.bb = NULL
for(i in z){
i$elapsed.time <- difftime(i$date.time, min(i$date.time), units='hour')
new.bb <- rbind(new.bb,i)
}
bb <- new.bb
# fitting dataframe to dd (DFC dataframe)
bb$id <- '1'
bb$treat <- 'bLS'
# from myg * s^-1* m^-2 to g * min^-1* m^-2
bb$flux <- as.numeric(bb$emis_NH3_gap) * 10^-6 * 60
# calculation of total flux over time
# last point * 30 min (time meas interval)
bb$flux.time <- bb$flux * 30
bb <- mutate(group_by(bb, tk, app.meth), cum.emis = cumsum(flux.time))
bb$id <- 'NA'
bbw <- bb
# subsetting:
bb <- bb[, c('elapsed.time', 'date.time', 'id', 'flux', 'cum.emis', 'tk', 'app.meth', 'treat')]
source('DFC_dataframe.R')
source('temp_sensors_dataframe.R')
source('subset_weather.R')
source('mearge.R')
source('subset_stats.R')
df1$app.meth <- mapvalues(df1$app.meth, from = 'TH', to = 'Trailing hose')
df2$app.meth <- mapvalues(df2$app.meth, from = 'TH', to = 'Trailing hose')
df1$app.meth <- mapvalues(df1$app.meth, from = 'IN', to = 'Injection')
df2$app.meth <- mapvalues(df2$app.meth, from = 'IN', to = 'Injection')
in1 <- factor(interaction(df1$app.meth, df1$treat))
in2 <- factor(interaction(df2$app.meth, df2$treat))
# Flux
ggplot(df1, aes(elapsed.time, flux, color = in1)) +
geom_point(shape = 1) +
geom_line(aes(group = interaction(tk, app.meth, id))) +
facet_wrap(~ tk, scale = 'free') +
theme_bw() +
scale_color_brewer(palette = 'Set1') +
ylab(expression(paste(NH[3]-N, '   flux [g  ',  min^-1, ' ', m^-2, ']'))) +
xlab('Time after slurry application [hours]') +
theme(legend.position = 'bottom', legend.title = element_blank())
ggsave2x('../plots-field-trials/flux_s', height = 3, width = 7)
ggsave2x('../plots-field-trials/flux_l', height = 7, width = 10)
ggplot(df1, aes(elapsed.time, flux.perc, color = in1)) +
geom_point(shape = 1) +
geom_line(aes(group = interaction(tk, app.meth, id))) +
facet_wrap(~ tk, scale = 'free') +
theme_bw() +
scale_color_brewer(palette = 'Set1') +
ylab(expression(paste('TAN [%]  ',  min^-1))) +
xlab('Time after slurry application [hours]') +
theme(legend.position = 'bottom', legend.title = element_blank())
ggsave2x('../plots-field-trials/flux_perc_s', height = 3, width = 7)
ggsave2x('../plots-field-trials/flux_perc_l', height = 7, width = 10)
# Cum emis
ggplot(df1, aes(elapsed.time, cum.emis, color = in1)) +
geom_point() +
geom_line(aes(group = interaction(tk, app.meth, id))) +
facet_wrap(~ tk, scale = 'free') +
theme_bw() +
scale_color_brewer(palette = 'Set1') +
ylab(expression(paste('Cumulative  ', NH[3]-N, '  [g  ', m^-2, ']'))) +
xlab('Time after digestate application [hours]') +
theme(legend.title = element_blank(), legend.position = 'bottom')
ggsave2x('../plots-field-trials/cum_emis_s', height = 3, width = 7)
ggsave2x('../plots-field-trials/cum_emis_l', height = 7, width = 10)
# Cum emis
ggplot(df1, aes(elapsed.time, cum.emis, color = in1)) +
geom_point(shape = 1) +
geom_line(aes(group = interaction(tk, app.meth, id))) +
facet_wrap(~ tk, scale = 'free') +
theme_bw() +
scale_color_brewer(palette = 'Set1') +
ylab(expression(paste('Cumulative  ', NH[3]-N, '  [g  ', m^-2, ']'))) +
xlab('Time after digestate application [hours]') +
theme(legend.title = element_blank(), legend.position = 'bottom')
ggsave2x('../plots-field-trials/cum_emis_s', height = 3, width = 7)
ggsave2x('../plots-field-trials/cum_emis_l', height = 7, width = 10)
ggplot(df2, aes(elapsed.time, cum.emis.mn, fill = in2, color = in2)) +
geom_point(shape = 1) +
geom_line(aes(group = in2)) +
geom_ribbon(aes(ymin = cum.emis.mn - cum.emis.sd, ymax = cum.emis.mn + cum.emis.sd, group = in2), alpha = 0.3, color = NA) +
facet_wrap(~ tk, scale = 'free') +
theme_bw() +
scale_color_brewer(palette = 'Set1') + scale_fill_brewer(palette = 'Set1') +
ylab(expression(paste('Cumulative  ', NH[3]-N, '  [g  ', m^-2, ']'))) +
xlab('Time after digestate application [hours]') +
theme(legend.title = element_blank(), legend.position = 'bottom')
ggsave2x('../plots-field-trials/cum_emis_mn_s', height = 3, width = 7)
ggsave2x('../plots-field-trials/cum_emis_mn_l', height = 7, width = 10)
ggplot(df1, aes(elapsed.time, cum.emis.perc, color = in1)) +
geom_point(shape = 1) +
geom_line(aes(group = interaction(tk, app.meth, id))) +
facet_wrap(~ tk, scale = 'free') +
theme_bw() +
scale_color_brewer(palette = 'Set1') +
ylab(expression(paste('Cumulative  ', NH[3]-N, '  [% TAN]'))) +
xlab('Time after digestate application [hours]') +
theme(legend.title = element_blank(), legend.position = 'bottom')
ggsave2x('../plots-field-trials/cum_emis_perc_s', height = 3, width = 7)
ggsave2x('../plots-field-trials/cum_emis_perc_l', height = 7, width = 10)
ggplot(df2, aes(elapsed.time, cum.emis.mn.perc, fill = in2, color = in2)) +
geom_point(shape = 1) +
geom_line(aes(group = in2)) +
geom_ribbon(aes(ymin = cum.emis.mn.perc - cum.emis.sd.perc, ymax = cum.emis.mn.perc + cum.emis.sd.perc, group = in2), alpha = 0.3, color = NA) +
facet_wrap(~ tk, scale = 'free') +
theme_bw() +
scale_color_brewer(palette = 'Set1') + scale_fill_brewer(palette = 'Set1') +
ylab(expression(paste('Cumulative  ', NH[3]-N, '  [% TAN]'))) +
xlab('Time after digestate application [hours]') +
theme(legend.title = element_blank(), legend.position = 'bottom')
ggsave2x('../plots-field-trials/cum_emis_mn_perc_s', height = 3, width = 7)
ggsave2x('../plots-field-trials/cum_emis_mn_perc_l', height = 7, width = 10)
# Weather
weather$what <- mapvalues(weather$what, from = 'airT', to = 'Temperature')
weather$what <- mapvalues(weather$what, from = 'WS', to = 'Wind speed')
weather$what <- mapvalues(weather$what, from = 'prec', to = 'Precipitation')
weather <- weather[weather$elapsed.time <= 120, ]
ggplot(na.omit(weather), aes(elapsed.time, num, color = what)) +
geom_line() +
facet_wrap(~ tk, scale = 'free') +
theme_bw() +
scale_color_brewer(palette = 'Set1') +
xlab('Time after slurry application [hours]') +
ylab(expression(paste("Temperature [ ",degree,"C] / Wind speed [ m ", s^-1, ']'))) +
theme(legend.position = 'bottom', legend.title = element_blank())
ggsave2x('../plots-field-trials/weather', height = 3, width = 7)
